{% extends 'burndown_for_what/base.html' %}
{% load render_markdown %}


{% block extra_js %}
  <script type="text/javascript">
    google.load('visualization', '1.1', {packages: ['corechart', 'line']});
    google.setOnLoadCallback(drawChart);

    function drawChart() {

      var data = new google.visualization.DataTable();
      data.addColumn('string', 'Day');
      data.addColumn('number', 'Score');
      data.addColumn('number', 'Burndown line');
      data.addColumn('number', 'Score Unplanned');

      data.addRows([
        {% for daily_date, score, burn_score, unplanned in burndown_data %}
          ['{{ daily_date }}',
            {% if score %}{{ score }}{% else%} null {% endif %},
            {{ burn_score }},
            {% if unplanned != None %}{{ unplanned }}{% else%} null {% endif %}
          ],
        {% endfor %}
      ]);

      var options = {
        title: 'Team: {{ team }}',
        subtitle: 'Name: {{ name }}',
        chart: {
          title: 'Team: {{ team }}',
          subtitle: 'Name: {{ name }}'
				},
				height: 700,
				vAxis: {
					title: 'Score',
					ticks: {{ yticks }},
					textStyle: {
						fontSize: 12
					}
        },
				hAxis: {
					textStyle: {
						fontSize: 11
					}
        },
				series: {
					1: {lineDashStyle: [2,2]}
				}

      };

      var chart = new google.visualization.LineChart(document.getElementById('line_bottom_x'));

      chart.draw(data, options);
    }
  </script>
{% endblock %}

{% block content %}


  <div class="bs-component">
    <div class="jumbotron">
      <div id="line_bottom_x"></div>
      {{ resume|markdownify|safe }}
    </div>
  </div>


  <div class="panel panel-primary">
    <div class="panel-heading">
      <h3 class="panel-title">Issues</h3>
    </div>
    <div class="panel-body">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Issue</th>
            <th>Title</th>
            <th>Score</th>
            <th>Assignee</th>
            <th>State</th>
            <th>Close At</th>
          </tr>
        </thead>
        <tbody>
          {% for issue in issues %}
            <tr>
              <th>{{ issue.number }}</th>
              <th>{{ issue.title }}</th>
              <th>{{ issue.score }}</th>
              <th>{{ issue.assignee_login }}</th>
              <th>{{ issue.state }}</th>
              <th>{{ issue.closed_at }}</th>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="panel panel-warning">
    <div class="panel-heading">
      <h3 class="panel-title">Issues Unplanned</h3>
    </div>
    <div class="panel-body">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Issue</th>
            <th>Title</th>
            <th>Score</th>
            <th>Assignee</th>
            <th>State</th>
            <th>Close At</th>
          </tr>
        </thead>
        <tbody>
          {% for issue in issues_unplanned %}
            <tr>
              <th>{{ issue.number }}</th>
              <th>{{ issue.title }}</th>
              <th>{{ issue.score }}</th>
              <th>{{ issue.assignee_login }}</th>
              <th>{{ issue.state }}</th>
              <th>{{ issue.closed_at }}</th>
            </tr>
          {% endfor %}
        </tbody>
      </div>
    </table>
  </div>
{% endblock %}
